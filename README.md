# å†·å„²å­˜å°å­˜å·¥å…·é›† (Cold Storage Archive Toolkit)

ä¸€å¥—å°ˆç‚ºé•·æœŸå†·å„²å­˜è¨­è¨ˆçš„æª”æ¡ˆå°å­˜å·¥å…·ï¼Œæä¾›å¾å£“ç¸®ã€é©—è­‰åˆ°è§£å£“ç¸®çš„å®Œæ•´è§£æ±ºæ–¹æ¡ˆã€‚

![Version](https://img.shields.io/badge/version-v2.1-blue)
![License](https://img.shields.io/badge/license-MIT-green)
![Shell](https://img.shields.io/badge/shell-bash-yellow)

## ğŸ¯ å°ˆæ¡ˆç›®æ¨™

å»ºç«‹ä¸€å¥—å°ˆæ¥­çš„å†·å„²å­˜å°å­˜ç³»çµ±ï¼Œç¢ºä¿è³‡æ–™èƒ½å¤ åœ¨ 10 å¹´å¾Œä¾ç„¶å®Œæ•´å¯è®€ï¼Œå…·å‚™ï¼š

- **é•·æœŸä¿å­˜æ€§**: ä½¿ç”¨æ¨™æº–æ ¼å¼ï¼ˆtar + zstdï¼‰ï¼Œç¢ºä¿æœªä¾†ç›¸å®¹æ€§
- **å®Œæ•´æ€§ä¿è­‰**: å¤šé‡é©—è­‰æ©Ÿåˆ¶ï¼ˆSHA-256 + BLAKE3 + PAR2ï¼‰
- **éŒ¯èª¤ä¿®å¾©**: 10% PAR2 å†—é¤˜ï¼Œå¯ä¿®å¾©æª”æ¡ˆæå£
- **é«˜å£“ç¸®æ¯”**: zstd æœ€ä½³åŒ–ï¼Œå£“ç¸®æ¯”å¯é” 60-80%
- **å¯é‡ç¾æ€§**: deterministic tarï¼Œç¢ºä¿ç›¸åŒè¼¸å…¥ç”¢ç”Ÿç›¸åŒè¼¸å‡º

## ğŸ“ å·¥å…·æ¦‚è¦½

| è…³æœ¬ | ç‰ˆæœ¬ | åŠŸèƒ½ | ä½¿ç”¨å ´æ™¯ |
|------|------|------|----------|
| `archive-compress.sh` | v2.1 | 7z â†’ tar.zst è½‰æ› + å®Œæ•´å°å­˜ | å»ºç«‹å†·å„²å­˜æª”æ¡ˆ |
| `verify-archive.sh` | v1.0 | å®Œæ•´æ€§é©—è­‰ | å®šæœŸæª¢æŸ¥æª”æ¡ˆå¥åº·ç‹€æ…‹ |
| `extract-archive.sh` | v2.0 | tar.zst è§£å£“ç¸® | å¿«é€Ÿè§£å£“ç¸®ï¼ˆå·²é©—è­‰æª”æ¡ˆï¼‰ |
| `verify-and-extract.sh` | v1.0 | é©—è­‰ + è§£å£“ç¸®çµ„åˆæµç¨‹ | å®‰å…¨çš„å®Œæ•´è™•ç†æµç¨‹ |

## ğŸ”§ ç³»çµ±éœ€æ±‚

### å¿…è¦å·¥å…·
```bash
# Ubuntu/Debian
sudo apt update && apt install tar zstd par2cmdline b3sum 7zip-full

# macOS (ä½¿ç”¨ Homebrew)
brew install zstd par2 b3sum p7zip

# CentOS/RHEL/Rocky Linux
sudo yum install tar zstd par2cmdline b3sum p7zip
```

### ç³»çµ±è¦æ ¼å»ºè­°
- **è¨˜æ†¶é«”**: 4GB+ RAMï¼ˆ`--long=31` éœ€è¦ç´„ 2.2GBï¼‰
- **ç£ç¢Ÿç©ºé–“**: åŸå§‹æª”æ¡ˆå¤§å°çš„ 2-3 å€ï¼ˆå«è‡¨æ™‚æª”æ¡ˆå’Œå†—é¤˜ï¼‰
- **è™•ç†å™¨**: å¤šæ ¸å¿ƒ CPUï¼ˆzstd æ”¯æ´å¤šåŸ·è¡Œç·’ï¼‰
- **å„²å­˜**: å»ºè­°ä½¿ç”¨ SSD æå‡è™•ç†æ•ˆèƒ½

## ğŸš€ å¿«é€Ÿé–‹å§‹

### 1. å£“ç¸®æª”æ¡ˆï¼ˆå»ºç«‹å†·å„²å­˜æª”æ¡ˆï¼‰
```bash
# åŸºæœ¬ä½¿ç”¨ï¼šè™•ç†ç•¶å‰ç›®éŒ„çš„ 7z æª”æ¡ˆ
./archive-compress.sh

# è™•ç†æŒ‡å®šç›®éŒ„
./archive-compress.sh /path/to/7z/files

# è‡ªè¨‚åƒæ•¸
./archive-compress.sh -l 15 -t 4 -o ~/backup /path/to/files
```

### 2. é©—è­‰æª”æ¡ˆå®Œæ•´æ€§
```bash
# é©—è­‰å–®ä¸€æª”æ¡ˆ
./verify-archive.sh archive.tar.zst

# é©—è­‰å¤šå€‹æª”æ¡ˆ
./verify-archive.sh *.tar.zst

# é©—è­‰æ•´å€‹ç›®éŒ„
./verify-archive.sh -d ./processed
```

### 3. è§£å£“ç¸®æª”æ¡ˆ
```bash
# å®Œæ•´æµç¨‹ï¼ˆæ¨è–¦ï¼‰ï¼šå…ˆé©—è­‰å†è§£å£“ç¸®
./verify-and-extract.sh archive.tar.zst

# å¿«é€Ÿè§£å£“ç¸®ï¼ˆå·²ç¢ºèªæª”æ¡ˆå®Œæ•´æ€§ï¼‰
./extract-archive.sh archive.tar.zst

# è§£å£“ç¸®åˆ°æŒ‡å®šç›®éŒ„
./extract-archive.sh -o /tmp/extract archive.tar.zst
```

## ğŸ“Š è¼¸å‡ºæª”æ¡ˆæ ¼å¼

æ¯å€‹ 7z æª”æ¡ˆç¶“è™•ç†å¾Œæœƒç”¢ç”Ÿä»¥ä¸‹æª”æ¡ˆï¼š

```
processed/
â””â”€â”€ archive_name/                          # å­ç›®éŒ„çµ„ç¹”ï¼ˆé è¨­ï¼‰
    â”œâ”€â”€ archive_name.tar.zst              # ä¸»æª”ï¼ˆzstd å£“ç¸®çš„ tarï¼‰
    â”œâ”€â”€ archive_name.tar.zst.sha256       # SHA-256 é›œæ¹Š
    â”œâ”€â”€ archive_name.tar.zst.blake3       # BLAKE3 é›œæ¹Š
    â”œâ”€â”€ archive_name.tar.zst.par2         # PAR2 ä¸»æª”æ¡ˆ
    â””â”€â”€ archive_name.tar.zst.vol000+xxx.par2  # PAR2 ä¿®å¾©æª”æ¡ˆï¼ˆ10% å†—é¤˜ï¼‰
```

## ğŸ› ï¸ è©³ç´°ä½¿ç”¨èªªæ˜

### archive-compress.sh - å£“ç¸®å·¥å…·

å°‡ 7z æª”æ¡ˆè½‰æ›ç‚ºç¬¦åˆå†·å„²å­˜æ¨™æº–çš„ tar.zst æ ¼å¼ã€‚

#### ä¸»è¦ç‰¹æ€§
- **åˆ†é›¢å¼è™•ç†**: tar å‰µå»º â†’ é©—è­‰ â†’ zstd å£“ç¸®ï¼ˆç¬¦åˆå†·å„²å­˜ SOPï¼‰
- **deterministic tar**: ä½¿ç”¨ `--sort=name` ç¢ºä¿å¯é‡ç¾æ€§
- **é«˜æ•ˆå£“ç¸®**: zstd æœ€ä½³åŒ–åƒæ•¸ï¼ˆ`--long=31`ï¼Œ2GB dictionary windowï¼‰
- **å¤šé‡é©—è­‰**: 5 éšæ®µé©—è­‰æµç¨‹
- **æ™ºèƒ½çµ„ç¹”**: å­ç›®éŒ„çµæ§‹é¿å…æª”æ¡ˆæ··äº‚

#### å¸¸ç”¨åƒæ•¸
```bash
./archive-compress.sh [é¸é …] [å·¥ä½œç›®éŒ„]

# ä¸»è¦é¸é …
-l, --level NUM        å£“ç¸®ç­‰ç´š (1-22, é è¨­: 19)
-t, --threads NUM      åŸ·è¡Œç·’æ•¸ (0=æ‰€æœ‰æ ¸å¿ƒ, é è¨­: 0)
-o, --output-dir DIR   è¼¸å‡ºç›®éŒ„ (é è¨­: ./processed)
--flat                 æ‰å¹³çµæ§‹ï¼Œä¸å‰µå»ºå­ç›®éŒ„
--no-long              åœç”¨é•·è·é›¢åŒ¹é…
--no-check             åœç”¨å®Œæ•´æ€§æª¢æŸ¥
```

#### ä½¿ç”¨ç¯„ä¾‹
```bash
# æ¨™æº–ä½¿ç”¨
./archive-compress.sh ~/archives

# é«˜å£“ç¸®æ¯” + è‡ªè¨‚è¼¸å‡º
./archive-compress.sh -l 22 -o /backup ~/archives

# å¿«é€Ÿè™•ç†ï¼ˆé™ä½å£“ç¸®ç­‰ç´šï¼‰
./archive-compress.sh -l 12 -t 8 ~/archives

# å‘å¾Œç›¸å®¹ï¼ˆæ‰å¹³çµæ§‹ï¼‰
./archive-compress.sh --flat ~/archives
```

### verify-archive.sh - é©—è­‰å·¥å…·

å° tar.zst æª”æ¡ˆé€²è¡Œå…¨é¢å®Œæ•´æ€§æª¢æŸ¥ã€‚

#### é©—è­‰é …ç›®
- âœ… zstd æª”æ¡ˆå®Œæ•´æ€§æª¢æŸ¥
- âœ… SHA-256 é›œæ¹Šé©—è­‰
- âœ… BLAKE3 é›œæ¹Šé©—è­‰  
- âœ… PAR2 å†—é¤˜å®Œæ•´æ€§æª¢æŸ¥
- âœ… tar å…§å®¹çµæ§‹é©—è­‰

#### å¸¸ç”¨åƒæ•¸
```bash
./verify-archive.sh [é¸é …] [æª”æ¡ˆè·¯å¾‘...]

# ä¸»è¦é¸é …
-d, --directory DIR    é©—è­‰ç›®éŒ„ä¸­çš„æ‰€æœ‰ tar.zst æª”æ¡ˆ
-v, --verbose         é¡¯ç¤ºè©³ç´°é©—è­‰è³‡è¨Š
-q, --quiet           å®‰éœæ¨¡å¼ï¼Œåªé¡¯ç¤ºçµæœ
```

#### ä½¿ç”¨ç¯„ä¾‹
```bash
# é©—è­‰å–®ä¸€æª”æ¡ˆ
./verify-archive.sh archive.tar.zst

# æ‰¹é‡é©—è­‰
./verify-archive.sh *.tar.zst

# é©—è­‰ç›®éŒ„ï¼ˆè©³ç´°æ¨¡å¼ï¼‰
./verify-archive.sh -v -d ./processed

# å®šæœŸæª¢æŸ¥ï¼ˆå®‰éœæ¨¡å¼ï¼‰
./verify-archive.sh -q -d /backup/archives
```

### extract-archive.sh - è§£å£“ç¸®å·¥å…·

å°ˆé–€è² è²¬ tar.zst æª”æ¡ˆçš„è§£å£“ç¸®æ“ä½œã€‚

#### ä¸»è¦ç‰¹æ€§
- **å…©éšæ®µè§£å£“ç¸®**: zstd è§£å£“ç¸® â†’ tar å±•é–‹
- **å®‰å…¨ç›®æ¨™ç›®éŒ„**: è‡ªå‹•å‰µå»ºç›®éŒ„ï¼Œè¦†è“‹ä¿è­·
- **æ•ˆèƒ½æœ€ä½³åŒ–**: ä½¿ç”¨æ­£ç¢ºçš„ zstd åƒæ•¸
- **åŸºæœ¬é©—è­‰**: è§£å£“ç¸®å¾Œæª”æ¡ˆæ•¸é‡å’Œå¤§å°çµ±è¨ˆ

#### å¸¸ç”¨åƒæ•¸
```bash
./extract-archive.sh [é¸é …] <æª”æ¡ˆè·¯å¾‘>

# ä¸»è¦é¸é …
-o, --output DIR      æŒ‡å®šè§£å£“ç¸®è¼¸å‡ºç›®éŒ„
-f, --force          å¼·åˆ¶è¦†è“‹ç¾æœ‰æª”æ¡ˆ
-v, --verbose        é¡¯ç¤ºè©³ç´°è§£å£“ç¸®è³‡è¨Š
-q, --quiet          å®‰éœæ¨¡å¼
```

#### ä½¿ç”¨ç¯„ä¾‹
```bash
# åŸºæœ¬è§£å£“ç¸®ï¼ˆè§£å£“ç¸®åˆ°æª”æ¡ˆåç›®éŒ„ï¼‰
./extract-archive.sh archive.tar.zst

# æŒ‡å®šè¼¸å‡ºç›®éŒ„
./extract-archive.sh -o /tmp/extract archive.tar.zst

# å¼·åˆ¶è¦†è“‹ + è©³ç´°æ¨¡å¼
./extract-archive.sh -f -v archive.tar.zst
```

### verify-and-extract.sh - çµ„åˆå·¥å…·

æä¾›å®Œæ•´çš„é©—è­‰èˆ‡è§£å£“ç¸®æµç¨‹ã€‚

#### å·¥ä½œæµç¨‹
1. **ç¬¬ä¸€éšæ®µ**: ä½¿ç”¨ `verify-archive.sh` é€²è¡Œå®Œæ•´é©—è­‰
2. **ç¬¬äºŒéšæ®µ**: ä½¿ç”¨ `extract-archive.sh` é€²è¡Œå®‰å…¨è§£å£“ç¸®

#### å¸¸ç”¨åƒæ•¸
```bash
./verify-and-extract.sh [é¸é …] <æª”æ¡ˆè·¯å¾‘>

# ä¸»è¦é¸é …
-o, --output DIR      æŒ‡å®šè§£å£“ç¸®è¼¸å‡ºç›®éŒ„
-f, --force          å¼·åˆ¶è¦†è“‹ç¾æœ‰æª”æ¡ˆ
-v, --verbose        é¡¯ç¤ºè©³ç´°è³‡è¨Š
--verify-only        åƒ…åŸ·è¡Œé©—è­‰ï¼Œä¸è§£å£“ç¸®
--skip-verify        è·³éé©—è­‰ç›´æ¥è§£å£“ç¸®ï¼ˆä¸å»ºè­°ï¼‰
```

#### ä½¿ç”¨ç¯„ä¾‹
```bash
# å®Œæ•´æµç¨‹ï¼ˆæ¨è–¦ï¼‰
./verify-and-extract.sh archive.tar.zst

# åƒ…é©—è­‰æ¨¡å¼
./verify-and-extract.sh --verify-only archive.tar.zst

# æŒ‡å®šè¼¸å‡ºç›®éŒ„
./verify-and-extract.sh -o /tmp/restore archive.tar.zst

# è©³ç´°æ¨¡å¼
./verify-and-extract.sh -v archive.tar.zst
```

## ğŸ”„ å…¸å‹å·¥ä½œæµç¨‹

### å†·å„²å­˜å»ºç«‹æµç¨‹
```bash
# 1. å£“ç¸®å»ºç«‹å†·å„²å­˜æª”æ¡ˆ
./archive-compress.sh ~/important_data

# 2. é©—è­‰ç”Ÿæˆçš„æª”æ¡ˆ
./verify-archive.sh -d ./processed

# 3. ç§»å‹•åˆ°å†·å„²å­˜ä½ç½®
cp -r ./processed/* /backup/cold_storage/
```

### å†·å„²å­˜æ¢å¾©æµç¨‹
```bash
# 1. å®šæœŸé©—è­‰ï¼ˆå»ºè­°æ¯å­£åº¦ï¼‰
./verify-archive.sh -d /backup/cold_storage

# 2. éœ€è¦æ™‚æ¢å¾©æª”æ¡ˆ
./verify-and-extract.sh /backup/cold_storage/archive.tar.zst

# 3. åƒ…é©—è­‰ä¸è§£å£“ç¸®
./verify-and-extract.sh --verify-only /backup/cold_storage/archive.tar.zst
```

## ğŸ”’ å®‰å…¨ç‰¹æ€§

### å®Œæ•´æ€§ä¿è­‰
- **å¤šé‡æ ¡é©—**: SHA-256 + BLAKE3 é›™é‡é›œæ¹Š
- **éŒ¯èª¤ä¿®å¾©**: PAR2 10% å†—é¤˜ï¼Œå¯ä¿®å¾©æª”æ¡ˆæå£
- **åˆ†éšæ®µé©—è­‰**: æ¯å€‹è™•ç†æ­¥é©Ÿéƒ½æœ‰é©—è­‰æ©Ÿåˆ¶

### å¯é‡ç¾æ€§
- **deterministic tar**: ç›¸åŒè¼¸å…¥ä¿è­‰ç›¸åŒè¼¸å‡º
- **æ¨™æº–æ ¼å¼**: ä½¿ç”¨ POSIX tar æ ¼å¼ï¼Œç¢ºä¿è·¨å¹³å°ç›¸å®¹

### é•·æœŸä¿å­˜
- **æ¨™æº–å·¥å…·**: åŸºæ–¼ tarã€zstd ç­‰å»£æ³›æ”¯æ´çš„æ ¼å¼
- **å‘å‰ç›¸å®¹**: 10 å¹´å¾Œä¾ç„¶å¯ç”¨æ¨™æº–å·¥å…·è®€å–

## ğŸ“ˆ æ•ˆèƒ½ç‰¹æ€§

### å£“ç¸®æ•ˆèƒ½
- **é«˜å£“ç¸®æ¯”**: é€šå¸¸å¯é” 60-80% å£“ç¸®æ¯”
- **å¤šåŸ·è¡Œç·’**: å……åˆ†åˆ©ç”¨å¤šæ ¸ CPU
- **è¨˜æ†¶é«”æœ€ä½³åŒ–**: 2GB dictionary window æå‡å¤§æª”æ¡ˆå£“ç¸®ç‡

### é©—è­‰æ•ˆèƒ½
- **ä¸¦è¡Œè™•ç†**: æ”¯æ´æ‰¹é‡é©—è­‰
- **å¢é‡æª¢æŸ¥**: å¯é¸æ“‡æ€§é©—è­‰ç‰¹å®šé …ç›®
- **å¿«é€Ÿæ¨¡å¼**: å®‰éœæ¨¡å¼é©åˆè‡ªå‹•åŒ–è…³æœ¬

## ğŸš¨ æ³¨æ„äº‹é …

### è³‡æºéœ€æ±‚
- è™•ç†å¤§æª”æ¡ˆï¼ˆ>2GBï¼‰æ™‚éœ€è¦è¼ƒé•·æ™‚é–“
- `--long=31` åƒæ•¸éœ€è¦ç´„ 2.2GB RAM
- å»ºè­°åœ¨ SSD ä¸Šé€²è¡Œè™•ç†ä»¥æå‡æ•ˆèƒ½

### ç£ç¢Ÿç©ºé–“
- è™•ç†éç¨‹ä¸­æœƒç”¢ç”Ÿè‡¨æ™‚æª”æ¡ˆ
- éœ€è¦è‡³å°‘åŸå§‹æª”æ¡ˆå¤§å° 2-3 å€çš„å¯ç”¨ç©ºé–“
- PAR2 å†—é¤˜é¡å¤–å ç”¨ 10% ç©ºé–“

### ç›¸å®¹æ€§
- æ‰€æœ‰è…³æœ¬éœ€è¦åœ¨åŒä¸€ç›®éŒ„æˆ– PATH ä¸­
- éœ€è¦ bash 4.0+ ç‰ˆæœ¬
- æ¨è–¦åœ¨ Linux/macOS ç’°å¢ƒä½¿ç”¨

## ğŸ“‹ ç–‘é›£æ’è§£

### å¸¸è¦‹å•é¡Œ

**Q: å‡ºç¾ "command not found" éŒ¯èª¤**
```bash
# æª¢æŸ¥å¿…è¦å·¥å…·æ˜¯å¦å®‰è£
which zstd tar par2 b3sum

# Ubuntu/Debian å®‰è£
sudo apt install tar zstd par2cmdline b3sum
```

**Q: è¨˜æ†¶é«”ä¸è¶³éŒ¯èª¤**
```bash
# ä½¿ç”¨è¼ƒå°çš„ dictionary window
./archive-compress.sh --no-long

# æˆ–é™ä½å£“ç¸®ç­‰ç´š
./archive-compress.sh -l 12
```

**Q: PAR2 é©—è­‰å¤±æ•—**
```bash
# å˜—è©¦ä¿®å¾©
par2 repair archive.tar.zst.par2

# æª¢æŸ¥æª”æ¡ˆæ˜¯å¦ç¢ºå¯¦æå£
./verify-archive.sh -v archive.tar.zst
```

**Q: æ¬Šé™éŒ¯èª¤**
```bash
# ç¢ºä¿è…³æœ¬æœ‰åŸ·è¡Œæ¬Šé™
chmod +x *.sh

# æª¢æŸ¥ç›®éŒ„å¯«å…¥æ¬Šé™
ls -la
```

## ğŸ¤ æœ€ä½³å¯¦è¸

### å®šæœŸç¶­è­·
- æ¯å­£åº¦åŸ·è¡Œå®Œæ•´æ€§é©—è­‰
- å®šæœŸæ¸¬è©¦æ¢å¾©æµç¨‹
- ä¿ç•™å¤šä»½å‚™ä»½åœ¨ä¸åŒä½ç½®

### æ•ˆèƒ½æœ€ä½³åŒ–
- åœ¨ SSD ä¸Šé€²è¡Œè™•ç†
- æ ¹æ“šç¡¬é«”èª¿æ•´åŸ·è¡Œç·’æ•¸é‡
- å¤§æ‰¹é‡è™•ç†æ™‚ä½¿ç”¨å®‰éœæ¨¡å¼

### å®‰å…¨å»ºè­°
- ä½¿ç”¨å®Œæ•´æµç¨‹ï¼ˆverify-and-extract.shï¼‰
- ä¿ç•™åŸå§‹æª”æ¡ˆç›´åˆ°é©—è­‰å®Œæˆ
- å®šæœŸæ›´æ–°å·¥å…·ç‰ˆæœ¬

## ğŸ“„ æˆæ¬Šå”è­°

MIT License - è©³è¦‹ LICENSE æª”æ¡ˆ

---

*æœ¬å·¥å…·é›†å°ˆç‚ºé•·æœŸå†·å„²å­˜è¨­è¨ˆï¼Œç¢ºä¿æ‚¨çš„é‡è¦è³‡æ–™èƒ½å¤ å®‰å…¨ä¿å­˜ä¸¦åœ¨æœªä¾†å®Œæ•´æ¢å¾©ã€‚* 